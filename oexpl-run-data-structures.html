<!Doctype html>
<html lang="en">
    <head>
        <title>OExpL Runtime Data Structures</title>
        <meta charset="UTF-8">
        <!--<link rel="stylesheet" href="css/bootstrap.min.css">-->
        <link rel="stylesheet" href="css/style_new.css">
        <link rel="stylesheet" href="js/embed-2cd369fa1c0830bd3aa06c21d4f14a13e060d2d31bbaae740f4af4.css"><div id="gist28627206" class="gist">
        <link rel="stylesheet" href="js/embed-cbe5b40fa72b0964f90d4919c2da8f8f94d7c9f6c2aa49c07f6fa3.css"><div id="gist28627206" class="gist">
        <script src="js/jquery-1.12.1.min.js" charset="utf-8"></script>
        <script src="js/bootstrap.min.js" charset="utf-8"></script>
        <script src="js/sticky_sidebar.js" charset="utf-8"></script>

    </head>
    <div class="container">
        <header id="navtop">
            <a href="index.html" class="logo fleft"><img src="img/logo.png" alt=""></a>
            <nav class="fright">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
        			    <li><a href="help.html">Help</a></li>
        			    <li><a href="roadmap.html">Roadmap</a></li>
        			    <li><a href="documentation.html" class="navactive">Documentation</a></li>
                </ul>
            </nav>
        </header>
        <body>
        <div class="Services-page main grid-wrap">
            <header class="grid col-full">
                <hr/>
                <p class="fleft">Runtime Data Structures for OExpl</p>
                <br>
                <br>
            </header>
            <aside class="grid col-one-quarter mq2-col-full sticky_sidebar">
              <menu>
                <ul>
                  <li><a class="sec" href="#nav-virtual-function-table">Virtual Function Table</a></li>
                  <li><a class="sec" href="#nav-illustration">Illustration</a></li>
                  <li><a class="sec" href="#nav-importance">Importance Of Virtual Function Table</a></li>
                  <li><a class="sec" href="#nav-resolve"></a>Resolving Strategy using Virtual Function Table</li>
              </ul>
              </menu>
              <!-- <a class="button" href="">Download as PDF</a> -->
            </aside>
            <section class="grid col-three-quarters mq2-col-full">
                <div class="grid-wrap">
                  <article class="grid col-full" id="nav-virtual-function-table">
                      <h2>Virtual Function Table</h2>
                      <p>

                        Virtual Function Table is a run time data structure that is used to resolve what method to be called when there is
                        inheritance, Polymorphism and Method Overriding and the exact method to be called cannot be decided at the compile time. For a virtual function table of a class, 8 blocks of memory is allocated.

                      </p>
                    </article>
                    <article class="grid col-full" id="nav-illustration">
                        <h2>Illustration</h2>

                          <script src="../js/71e1ad248ff055d56e110287d80d0b0a.js"></script>
                            <ol>
                            <li>

                          <p>

                             Virtual function table starts at 4096 in the stack, and it grows with the increase in number of the classes.
                             <br />
                             After creating the virtual function table, we will allocate the space for global declarations.
                             <br />
                             By using the class index, the starting address in virtual function table for that particular class is known.
                             <br />
                             Starting at index 4096, the <b>(class index * 8 + 4096)</b> is the address of the current class virtual function table. The class index starts from 0.

                           </p>

                           </li>

                             <li>



                             For every method declaration, a new label is alloted.
                             <br />
                             In the given example, the function f1 in class A gets a <b>funcposition 0</b> and say <b>flabel f1</b> and the function f2 in class A gets a <b>funcposition 1</b> and say <b>flabel f2</b>.

                          <p>

                              The member function list of class A looks as shown in the below figure :
                                <br><a href="../img/virtual_function_table_3.png"> <img src="../img/virtual_function_table_3.png"></img></a>
                              <br />
                              The virtual function table of class A looks as shown in the figure below. It is constructed using member function list of class A which is shown in the figure above.
                              <!--Similarly for <i>rollno,aerage,findaverage(linkedlist marks)</i>, symbol table entries are formed and installed.-->

                            <br><a href="../img/virtual_function_table_1.png">  <img src="../img/virtual_function_table_1.png"></img></a>
                            <br />All the labels of the functions will be replaced with addresses.
                          </p>
                          </li>

                          <li>
                            <!--
                        <p>
                           For every method declaration, a new label is alloted.
                           In class A, the function f1 gets an index 0 an say label f1 and
                            <br/>  the function f2 gets an index 1 and say a label f2.
                        </p>


                            Following is how virtual function table looks in the stack when <i>A</i> class is installed.<br>-->
                            <!--Similarly for <i>rollno,average,findaverage(linkedlist marks)</i>, symbol table entries are formed and installed.-->
                            In class B, there are two methods f1() and f3() and it is extending class A. When a class extends other class,
                            all the member fields and methods of the parent class are inherited by the derived class. Suppose as in this example,
                            if the method signatures of the parent class and the derived class match, then method overriding occurs.
                            <br />
                            <a href="https://en.wikipedia.org/wiki/Method_overriding">Method Overriding</a> means the definition of the method that belongs to
                            parent class is replaced by the definition of the method which is already present in the derived class.
                            Here, f1() method of class B overrides the f1() method of class A.
                            Let us see how the process of method overriding occurs, how the member function list is updated for the derived class.
                            This is demonstrated using the classes B and A of this OExpL program.

                            Here, class B is extending class A.
                            So, all the member fields and methods of class A is inherited by class B.

                          <!--  So, now the member function list looks as shown in the figure below.

                            <img /> -->

                            Here method f1() derived from class A, will be overridden by the method f1() of class B.
                            As stated above, a new label will be alloted, for the f1() method of class B.
                            Now, we need to update the member func list entry of the f1() method in class B, by new flabel given to the method f1() of class B.
                            Similarly, the member func list for class C will be constructed.
                            The final class tables and corresponding member function lists are shown in the figure below.
                            <br /><br />
                            <br><a href="../img/virtual_function_table_4.png"> <img src="../img/virtual_function_table_4.png"></img></a>
                          <br />  The virtual function tables of all the classes is shown in the figure below :
                            <br />
                            <br><a href="../img/virtual_function_table_2.png">  <img src="../img/virtual_function_table_2.png"></img></a>
                            <br />
                        </li>


                        </ol>
                    </article>

                    <article class="grid col-full" id="nav-importance">
                      <h2>Importance</h2>
                      <script src="../js/9fab0ed1079cbf0ebdae2916b4272929.js"></script>
                      From the above code, the calling of the function depends on the input value n.
                      If n < 0, the method in the class A is called.
                      If n = 0, the method in the class B is called.
                      If n > 0, the method in the class C is called.
                      So, Depending on the value of n, the obj gets the address.
                      Even though the three methods which are overridden has the same name f1(), the labels will be different.
                      The statement CALL F_LABEL could not be generated, because at the compile time we cannot decide the flabel value.
                      The label of the function cannot be decided.
                      flabel should be determined according to the object the class variable gets.
                    </article>

                    <article class="grid col-full" id="nav-resolve">
                      <h2>Resolving Strategy</h2>

                      For every class variable, generally one block of memory in stack is allocated.
                      But with the introduction of subtyping, we face the problem of resolution of which method to call as shown in the example
                      above.
                      So, now to resolve this we use virtual function table and every class variable will be allocated two blocks of memory.
                      One block is used to store the heap address and the other block is used to store the starting address of the virtual function table.



                      <h4> During Compile Time</h4>

                      In the above example, when compiler reaches the statement, <b>obj.f1()</b>, it checks the type of obj, which means
                      to which class the <b>obj</b> belongs to. Then it gets the member function list of the class of that object and checks if there
                      is any method with name <b>f1()</b>. If it finds a method, it proceeds with the compilation. If it doesn't find, then it is a
                      compilation error.

                      When it encounters the statement, <b> obj = new(A);</b>, the second block of object is set.
                      The second block of the object is to be set with the starting address of virtual function table of a class.
                      So, here,
                      (4096 + class_index * 8) is the starting address of virtual function table of the required class.

                      <h4>During Run Timw</h4>

                      The class_index value is obtained during the run time.
                      With this, the object stores the virtual function table address of the required class in which the method to be called is present.
                      The funcposition in the virtual function table will be same for all the methods with same name, in different classes.
                      Let start_index be the starting index of the virtual function table of the required class.
                      Now, start_index + class_index gives the flabel of the exact function to be called.

                    </article>


                  </div>
              </section>

           </div>
           </div>
           <footer class="center part clearfix">
           <ul class="grid col-one-third social">
               <li><a href="http://github.com/silcnitc">Github</a></li>
           </ul>
           <div class="grid col-one-third" style="color:black;">
               <p style="font-weight: bold;">Contributed By : <a href="#">J.Ritesh</a> <br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<a href="#">J.Phani Koushik</a><br> &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<a href="#">M.Jaya Prakash</a>
               </p>
           </div>
           <nav class="grid col-one-third ">
               <ul >
                   <li><a href="index.html">Home</a></li>
                   <li><a href="about.html">About</a></li>
                   <!-- <li><a href="uc.html">Contact</a></li> -->
               </ul>
           </nav>
           <br>
           </footer>
           <script>window.jQuery || document.write('<script src="js/jquery-1.7.2.min.js"><\/script>')</script>
           <script src="js/scripts.js"></script>
           </body>
           </html>
